"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E=require("@babel/plugin-transform-react-jsx"),m=require("node:path"),g=require("node:url"),p=require("@babel/helper-plugin-utils"),_=require("@babel/types"),c=typeof document<"u"?document.currentScript:null;function v(s){var n=Object.create(null);return s&&Object.keys(s).forEach(function(r){if(r!=="default"){var i=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return s[r]}})}}),n.default=s,Object.freeze(n)}var e=v(_);const h=m.dirname(g.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:c&&c.tagName.toUpperCase()==="SCRIPT"&&c.src||new URL("index.js",document.baseURI).href)),S=p.declare(s=>(s.assertVersion(7),{name:"log-jsx-plugin",visitor:{Program(n,r){if(r.filename?.includes(m.resolve(h,"../../../vynn")))return;let i=!1;if(n.get("body").forEach(t=>{t.isImportDeclaration()&&t.node.source.value==="vynn/jsx-runtime"&&t.node.specifiers.forEach(o=>{if(e.isImportSpecifier(o)){const l=o.imported;e.isIdentifier(l)&&l.name==="logJsx"&&(i=!0)}})}),!i){const t=e.importDeclaration([e.importSpecifier(e.identifier("logJsx"),e.identifier("logJsx"))],e.stringLiteral("vynn/jsx-runtime"));n.unshiftContainer("body",t)}},CallExpression(n){const r=n.get("callee");if(e.isMemberExpression(r.node)&&e.isIdentifier(r.node.object,{name:"console"})&&e.isIdentifier(r.node.property)){const i=n.node.arguments.map(t=>e.isJSXElement(t)||e.isJSXFragment(t)?e.callExpression(e.identifier("logJsx"),[t]):t);i.some((t,o)=>t!==n.node.arguments[o])&&(n.node.arguments=i)}}}})),J=p.declare(s=>(s.assertVersion(7),{name:"loop-auto-wrap-plugin",pre(){const n=this.file.metadata;n.importedLoops=new Set,n.localLoops=new Set},visitor:{Program(n,r){const i=r.file.metadata,t=i.importedLoops,o=i.localLoops;n.get("body").forEach(l=>{l.isImportDeclaration()&&l.node.source.value==="vynn"&&l.node.specifiers.forEach(a=>{e.isImportSpecifier(a)&&e.isIdentifier(a.imported,{name:"loop"})&&t.add(a.local.name)}),l.isFunctionDeclaration()&&e.isIdentifier(l.node.id)&&o.add(l.node.id.name),l.isVariableDeclaration()&&l.node.declarations.forEach(a=>{e.isIdentifier(a.id)&&o.add(a.id.name)})})},CallExpression(n,r){const i=r.file.metadata,t=i.importedLoops,o=i.localLoops,l=n.get("callee");if(!l.isIdentifier())return;const a=l.node.name;if(t.has(a)&&!o.has(a)&&n.node.arguments.length===1){const d=n.node.arguments[0];!e.isArrowFunctionExpression(d)&&e.isExpression(d)&&(n.node.arguments[0]=e.arrowFunctionExpression([],d))}}}})),j=p.declare(s=>{s.assertVersion(7);function n(r){const i=[];if(r.node.children.forEach((o,l)=>{if(e.isJSXText(o)){let a=o.value;(!a.includes(`
`)||a.trim()!=="")&&(l===0&&(a=a.trimStart()),l===r.node.children.length-1&&(a=a.trimEnd()),i.push(e.addComment(e.arrowFunctionExpression([],e.stringLiteral(a)),"leading","#__PURE__")))}else if(e.isJSXElement(o)||e.isJSXFragment(o))i.push(e.addComment(e.arrowFunctionExpression([],o),"leading","#__PURE__"));else if(e.isJSXExpressionContainer(o)&&!e.isJSXEmptyExpression(o.expression)){const a=o.expression;e.isStringLiteral(a)?i.push(a):i.push(e.addComment(e.arrowFunctionExpression([],a),"leading","#__PURE__"))}}),i.length===0)return;let t=i.length===1?i[0]:e.arrayExpression(i);e.isArrowFunctionExpression(t)||(t=e.addComment(e.arrowFunctionExpression([],t),"leading","#__PURE__")),r.node.children=[e.jsxExpressionContainer(t)]}return{name:"wrap-jsx-children-plugin",visitor:{JSXElement(r){n(r)},JSXFragment(r){n(r)}}}}),w=p.declare(s=>(s.assertVersion(7),{name:"wrap-jsx-expression-plugin",visitor:{JSXOpeningElement(n){const r=n.node.attributes.map(i=>{if(!e.isJSXAttribute(i)||!i.value)return i;const t=e.isJSXIdentifier(i.name)?i.name.name:null;if(t==="ref"&&e.isJSXExpressionContainer(i.value)&&e.isIdentifier(i.value.expression)){const a=i.value.expression,d=e.identifier("elem"),f=e.assignmentExpression("=",a,d),x=e.addComment(e.arrowFunctionExpression([d],f),"leading","#__PURE__");return e.jsxAttribute(e.jsxIdentifier(t),e.jsxExpressionContainer(x))}let o=null;if(e.isStringLiteral(i.value)?o=i.value:e.isJSXExpressionContainer(i.value)&&(e.isJSXEmptyExpression(i.value.expression)||(o=i.value.expression)),o===null||t===null)return i;const l=e.addComment(e.arrowFunctionExpression([],o),"leading","#__PURE__");return e.jsxAttribute(e.jsxIdentifier(t),e.jsxExpressionContainer(l))});n.node.attributes=r},JSXExpressionContainer(n){const r=n.node.expression;if(e.isJSXEmptyExpression(r)||e.isFunction(r)||e.isArrowFunctionExpression(r)||e.isLiteral(r))return;const i=e.addComment(e.arrowFunctionExpression([],r),"leading","#__PURE__");n.replaceWith(e.jsxExpressionContainer(i))}}}));function u(s){return s?e.isJSXElement(s)||e.isJSXFragment(s)?!0:e.isConditionalExpression(s)?u(s.consequent)||u(s.alternate):e.isLogicalExpression(s)?u(s.left)||u(s.right):e.isArrayExpression(s)?s.elements.some(n=>n&&!e.isSpreadElement(n)?u(n):!1):!1:!1}const C=p.declare(s=>(s.assertVersion(7),{name:"wrap-jsx-variables",visitor:{VariableDeclarator(n){const r=n.node.init;r&&u(r)&&!e.isArrowFunctionExpression(r)&&(n.node.init=e.arrowFunctionExpression([],r))},AssignmentExpression(n){const r=n.node.right;u(r)&&!e.isArrowFunctionExpression(r)&&(n.node.right=e.arrowFunctionExpression([],r))}}})),b=p.declare(s=>(s.assertVersion(7),{name:"pure-jsx-calls-plugin",visitor:{CallExpression(n){const r=n.node.callee;e.isIdentifier(r)&&(r.name==="_jsx"||r.name==="_jsxs")&&e.addComment(n.node,"leading","#__PURE__")}}}));function F(s,n={ssr:!1}){return s.assertVersion(7),{plugins:[[E,{runtime:"automatic",importSource:n.ssr?"vynn/server":"vynn",jsx:"preserve"}],S,C,J,j,w,b]}}exports.default=F;
//# sourceMappingURL=index.js.map
