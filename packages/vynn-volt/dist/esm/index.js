import{serverFunctions as c}from"@vinxi/server-functions/plugin";import t from"path";import{createApp as a}from"vinxi";import l from"vite-plugin-vynn";import i from"vite-tsconfig-paths";import u from"node:fs";import{BaseFileSystemRouter as m,cleanPath as f}from"vinxi/fs-router";class d extends m{toPath(r){if(!/page\.(t|j)sx?$/.test(t.basename(r)))return"";const e=f(r,this.config).replace(/\/page$/,"").replace(/\[([^/]+)\]/g,(n,s)=>s.startsWith("...")?`*${s.slice(3)}`:`:${s}`);return e?.length>0?`${e}`:"/"}toRoute(r){const e=this.toPath(r);if(!e)return null;const n=t.dirname(r),s=t.join(n,"layout.tsx");return{$$component:{src:r,pick:["default"]},...u.existsSync(s)?{$$layout:{src:s,pick:["default"]}}:{},path:e,filePath:r}}}function p({dir:o}){return(r,e)=>new d({dir:o,extensions:["tsx","ts","jsx","js"]},r,e)}function g({plugins:o,server:r={}}){const e=process.cwd();return a({devtools:!0,server:{compressPublicAssets:{brotli:!process.versions.bun},...r},routers:[{name:"public",type:"static",dir:t.resolve(e,"./public"),base:"/"},{name:"ssr",type:"http",base:"/",target:"server",handler:t.resolve(e,"./src/entry-server.tsx"),plugins:()=>[l({ssr:!0}),i(),...o],routes:p({dir:t.resolve(e,"./src/app")}),link:{client:"client"}},{name:"client",type:"client",base:"/_build",target:"browser",handler:t.resolve(e,"./src/entry-client.tsx"),plugins:()=>[c.client(),l({ssr:!0}),i(),...o],routes:p({dir:t.resolve(e,"./src/app")})},c.router({plugins:()=>[i()]})]})}export{g as defineConfig};
//# sourceMappingURL=index.js.map
